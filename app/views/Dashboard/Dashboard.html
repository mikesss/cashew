<div class="pure-g">
  <div class="pure-u-1-3">
    <div ng-hide="dash.payables.length === 0">
      <h2 class="section-header">Upcoming Payables</h2>
      <div class="upcoming_lineitems" ng-repeat="item in dash.payables | orderBy: 'dueDate'" ng-init="showEnterAmt = false">
        <button class="transparent-bg" ng-click="dash.togglePaid(item)" ng-show="dash.hasValidAmount(item) && !showEnterAmt">
          <i class="fa fa-square-o" style="color: #aaa" ng-hide="item.payment"></i>
          <i class="fa fa-check-square-o" style="color: #333" ng-show="item.payment"></i>
        </button>
        <button class="transparent-bg" ng-click="showEnterAmt = showEnterAmt ? false : true; item.amount = null" ng-hide="dash.hasValidAmount(item) && !showEnterAmt">
          <i class="fa fa-square-o" style="color: #aaa" ng-hide="showEnterAmt"></i>
          <i class="fa fa-close" style="color: #333" ng-show="showEnterAmt"></i>
        </button>

        <span ng-class="{'paid': item.payment}">{{item.name}}</span>
        <span ng-class="{'amount_label_paid paid' : item.payment, 'amount_label' : !item.payment}" ng-show="dash.hasValidAmount(item)">
          {{(item.remainingAmount ? item.remainingAmount : item.amount) | currency}}
          <span style="color: #FFBFCB; font-size: 9pt;" ng-show="item.split">of {{item.amount | currency}}</span>
        </span>
        <span class="due_label">{{item.dueDate.toDate() | date: 'MMM d'}}</span>

        <div ng-show="showEnterAmt" style="margin-top: 5px;">
          <form ng-submit="dash.togglePaid(item)" class="pure-form">
            <input class="num_long" ng-model="item.amount" ng-focus="dash.suggestAmount(item)" type="text" pattern="[0-9]+\.?[0-9]?[0-9]?" placeholder="Amount paid">
            <button class="pure-button" ng-show="dash.hasValidAmount(item)" ng-click="showEnterAmt = false">Done</button>
          </form>
        </div>
      </div>
    </div>

    <div ng-hide="dash.asides.length === 0">
      <h2 class="section-header">{{dash.getNow().toDate() | date: 'MMMM'}} Set-Asides</h2>
      <div class="upcoming_lineitems" ng-repeat="item in dash.asides | orderBy: 'original.dueDate'">
        <input type="checkbox" ng-checked="item.payment" ng-click="dash.togglePaid(item)">
        <span ng-class="{'paid': item.payment}">{{item.original.name}}</span>
        <span ng-class="{'amount_label_paid paid' : item.payment, 'amount_label' : !item.payment}">{{item.amount | currency}}</span>
        <span class="due_label">{{item.original.dueDate.toDate() | date: 'MMM d, yyyy'}}</span>
        <div class="progress-bar">
          <div class="progress" ng-class="{'no-bg-color': dash.getPercentComplete(item)===0}" ng-style="{'width': dash.getPercentComplete(item) + '%'}">
            {{dash.getPercentComplete(item)}}%
          </div>
        </div>
      </div>
    </div>

    <p ng-show="dash.payables.length + dash.asides.length === 0" style="padding: 10px;">
      No payables? Manage line items on <a href="#/line-items">the Planning page</a>.
    </p>
  </div>
  <div class="pure-u-2-3">
    <div>
      <table id="calendar" class="pure-table pure-table-bordered">
        <thead>
          <tr>
            <th>Sun</th>
            <th>Mon</th>
            <th>Tue</th>
            <th>Wed</th>
            <th>Thu</th>
            <th>Fri</th>
            <th>Sat</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="week in dash.datesArray">
            <td ng-repeat="d in week" ng-class="{'out_of_range': dash.isOutOfRange(d)}">
              <span ng-class="{'today' : dash.isToday(d)}">
                <span ng-show="$parent.$index === 0 && $index === 0 || d.getDate() === 1" class="month_label">{{ d | date: 'MMM' }}</span>
                <span style="font-size: 10pt;">{{ d | date: 'd' }}</span>
              </span>
              <span ng-repeat="item in dash.payablesOn(d)" ng-class="{'amount_label_paid' : item.payment, 'amount_label' : !item.payment}">
                <span ng-show="dash.hasValidAmount(item)">
                  {{(item.remainingAmount ? item.remainingAmount : item.amount) | currency}}
                </span>
                <span ng-hide="dash.hasValidAmount(item)">
                  {{item.name}}
                </span>
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
